<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Factor Analysis – MQAT</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./clusters.html" rel="next">
<link href="./linear-regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-77cb982c3ae5178da5248b9c8921380f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-0b1e80eae3a2d67fe1799060ddf1655e.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="citation_title" content="[7]{.chapter-number}&nbsp; [Factor Analysis]{.chapter-title}">
<meta name="citation_fulltext_html_url" content="https://U-Shift.github.io/MQAT/factor-analysis.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Literate programming;,citation_author=Donald E. Knuth;,citation_publication_date=1984-05;,citation_cover_date=1984-05;,citation_year=1984;,citation_fulltext_html_url=https://doi.org/10.1093/comjnl/27.2.97;,citation_issue=2;,citation_doi=10.1093/comjnl/27.2.97;,citation_issn=0010-4620;,citation_volume=27;,citation_journal_title=Comput. J.;,citation_publisher=Oxford University Press, Inc.;">
<meta name="citation_reference" content="citation_title=Mobilidade e funcionalidade do território nas Áreas Metropolitanas do Porto e de Lisboa: 2017;,citation_author=undefined INE;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://www.ine.pt/xportal/xmain?xpid=INE&amp;amp;amp;xpgid=ine_publicacoes&amp;PUBLICACOESpub_boui=349495406&amp;PUBLICACOESmodo=2&amp;xlang=pt;,citation_isbn=978-989-25-0478-0;,citation_technical_report_institution=Instituto National de Estatística;">
<meta name="citation_reference" content="citation_title=Censos 2021- XVI Recenseamento Geral da População. VI Recenseamento Geral da Habitação;,citation_author=undefined INE;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://censos.ine.pt/xurl/pub/65586079;,citation_isbn=978-989-25-0619-7;,citation_technical_report_institution=Instituto National de Estatística;">
<meta name="citation_reference" content="citation_title=Spatial data science: With applications in R;,citation_author=Edzer Pebesma;,citation_author=Roger Bivand;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1201/9780429459016;,citation_doi=10.1201/9780429459016;">
<meta name="citation_reference" content="citation_title=Jittering: A computationally efficient method for generating realistic route networks from origin-destination data;,citation_author=Robin Lovelace;,citation_author=Rosa Félix;,citation_author=Dustin Carlino;,citation_publication_date=2022-04-08;,citation_cover_date=2022-04-08;,citation_year=2022;,citation_doi=10.32866/001c.33873;,citation_journal_title=Findings;,citation_publisher=Findings Press;">
<meta name="citation_reference" content="citation_title=r5r: Rapid realistic routing on multimodal transport networks with r&amp;amp;amp;lt;sup&amp;gt;5&amp;lt;/sup&amp;gt; in r;,citation_author=Rafael H. M. Pereira;,citation_author=Marcus Saraiva;,citation_author=Daniel Herszenhut;,citation_author=Carlos Kaue Vieira Braga;,citation_author=Matthew Wigginton Conway;,citation_publication_date=2021-03-04;,citation_cover_date=2021-03-04;,citation_year=2021;,citation_doi=10.32866/001c.21262;,citation_journal_title=Findings;,citation_publisher=Findings Press;">
<meta name="citation_reference" content="citation_title=Centr: Weighted and unweighted spatial centers;,citation_author=Ryan Zomorrodi;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://ryanzomorrodi.github.io/centr/;">
<meta name="citation_reference" content="citation_title=Stplanr: A package for transport planning;,citation_author=Robin Lovelace;,citation_author=Richard Ellison;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=2;,citation_doi=10.32614/RJ-2018-053;,citation_volume=10;,citation_journal_title=The R Journal;">
<meta name="citation_reference" content="citation_title=Od: Manipulate and map origin-destination data;,citation_author=Robin Lovelace;,citation_author=Malcolm Morgan;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://github.com/itsleeds/od;">
<meta name="citation_reference" content="citation_title=Introduction to r;,citation_author=Claudia A Engel;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=cengel.github.io/R-intro/;">
<meta name="citation_reference" content="citation_title=Geocomputation with r;,citation_author=Robin Lovelace;,citation_author=Jakub Nowosad;,citation_author=Jannes Muenchow;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://r.geocompx.org/;">
<meta name="citation_reference" content="citation_title=Introduction to urban accessibility: A practical guide with r;,citation_author=Rafael HM Pereira;,citation_author=Daniel Herszenhut;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://ipeagit.github.io/intro_access_book/;">
<meta name="citation_reference" content="citation_title=R for data science;,citation_author=Hadley Wickham;,citation_author=Mine Çetinaka-Rundel;,citation_author=Garrett Grolemund;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://r4ds.hadley.nz/;">
<meta name="citation_reference" content="citation_title=Openrouteservice: An ’openrouteservice’ API client;,citation_author=Andrzej K. Oleś;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://github.com/GIScience/openrouteservice-r;">
<meta name="citation_reference" content="citation_title=Assessment of Residential Location Satisfaction in the Lisbon Metropolitan Area;,citation_abstract=This paper addresses the relationship between travel behavior and land use patterns using a Structural Equations Modeling framework and a more comprehensive modeling than in the past. The proposed model structure in this paper is by design heavily influenced by a model developed for Lisbon (1) to allow comparisons. In that paper the existence of significant effects of land use patterns in travel behavior was found. The travel behavior variables included in the model are multidimensional and comprehend both short term, number of trips by mode and trip scheduling, and long term, home location, car and pass ownership, mobility decisions. The modeled land use variables measure the levels of urban intensity and density, diversity, both in terms of types of uses and the mix between jobs and inhabitants and the public transport supply levels. The land use patterns are described both at the residence and employment zones. In order to explicitly account for self selection bias the land use variables are explicitly modeled as functions of socioeconomic attributes of individuals and their households. The Seattle findings are presented and then compared to the Lisbon findings. Many commonalities between the two environments were found but also many important differences. ;,citation_author=Luís Garrido Martinez;,citation_author=João Abreu e Silva;,citation_author=José Manuel Viegas;,citation_publication_date=2010-01;,citation_cover_date=2010-01;,citation_year=2010;,citation_fulltext_html_url=https://trid.trb.org/View/909819;">
<meta name="citation_reference" content="citation_title=Discovering statistics using IBM SPSS statistics;,citation_author=A. Field;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://books.google.pt/books?id=83L2EAAAQBAJ;,citation_isbn=9781529668704;">
<meta name="citation_reference" content="citation_title=Discovering statistics using SPSS;,citation_author=Andy Field;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_isbn=1-84787-906-3;">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./r-basics.html"><strong>Data and Models</strong></a></li><li class="breadcrumb-item"><a href="./factor-analysis.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Factor Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MQAT</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/U-Shift/MQAT" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Software</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Data and Models</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factor-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clusters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>GIS in R</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to spatial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Interactive maps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./centroids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Centroids of transport zones</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./desire-lines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">OD pairs and desire lines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./distances.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Euclidean and routing distances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./buffers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Buffers vs.&nbsp;Isochones</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./open-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Open transportation data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Grids</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages"><span class="header-section-number">7.1</span> Load packages</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"><span class="header-section-number">7.2</span> Dataset</a>
  <ul class="collapse">
  <li><a href="#import-dataset" id="toc-import-dataset" class="nav-link" data-scroll-target="#import-dataset"><span class="header-section-number">7.2.1</span> Import dataset</a></li>
  <li><a href="#get-to-know-your-dataset" id="toc-get-to-know-your-dataset" class="nav-link" data-scroll-target="#get-to-know-your-dataset"><span class="header-section-number">7.2.2</span> Get to know your dataset</a></li>
  </ul></li>
  <li><a href="#assumptions-for-factoral-analysis" id="toc-assumptions-for-factoral-analysis" class="nav-link" data-scroll-target="#assumptions-for-factoral-analysis"><span class="header-section-number">7.3</span> Assumptions for factoral analysis</a>
  <ul class="collapse">
  <li><a href="#normality" id="toc-normality" class="nav-link" data-scroll-target="#normality"><span class="header-section-number">7.3.1</span> Normality</a></li>
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity"><span class="header-section-number">7.3.2</span> Linearity</a></li>
  <li><a href="#homogeneity" id="toc-homogeneity" class="nav-link" data-scroll-target="#homogeneity"><span class="header-section-number">7.3.3</span> Homogeneity</a></li>
  <li><a href="#correlations-between-variables" id="toc-correlations-between-variables" class="nav-link" data-scroll-target="#correlations-between-variables"><span class="header-section-number">7.3.4</span> Correlations between variables</a></li>
  </ul></li>
  <li><a href="#determine-the-number-of-factors-to-extract" id="toc-determine-the-number-of-factors-to-extract" class="nav-link" data-scroll-target="#determine-the-number-of-factors-to-extract"><span class="header-section-number">7.4</span> Determine the number of factors to extract</a>
  <ul class="collapse">
  <li><a href="#parallel-analysis" id="toc-parallel-analysis" class="nav-link" data-scroll-target="#parallel-analysis"><span class="header-section-number">7.4.1</span> Parallel Analysis</a></li>
  <li><a href="#kaiser-criterion" id="toc-kaiser-criterion" class="nav-link" data-scroll-target="#kaiser-criterion"><span class="header-section-number">7.4.2</span> Kaiser Criterion</a></li>
  <li><a href="#principal-component-analysis-pca" id="toc-principal-component-analysis-pca" class="nav-link" data-scroll-target="#principal-component-analysis-pca"><span class="header-section-number">7.4.3</span> Principal Component Analysis (PCA)</a></li>
  </ul></li>
  <li><a href="#exploratory-factor-analysis-efa" id="toc-exploratory-factor-analysis-efa" class="nav-link" data-scroll-target="#exploratory-factor-analysis-efa"><span class="header-section-number">7.5</span> Exploratory Factor Analysis (EFA)</a>
  <ul class="collapse">
  <li><a href="#rotational-indeterminacy" id="toc-rotational-indeterminacy" class="nav-link" data-scroll-target="#rotational-indeterminacy"><span class="header-section-number">7.5.1</span> Rotational indeterminacy</a></li>
  <li><a href="#factor-scores-and-factor-loadings" id="toc-factor-scores-and-factor-loadings" class="nav-link" data-scroll-target="#factor-scores-and-factor-loadings"><span class="header-section-number">7.5.2</span> Factor scores and factor loadings</a></li>
  <li><a href="#visualize-rotation" id="toc-visualize-rotation" class="nav-link" data-scroll-target="#visualize-rotation"><span class="header-section-number">7.5.3</span> Visualize Rotation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./r-basics.html"><strong>Data and Models</strong></a></li><li class="breadcrumb-item"><a href="./factor-analysis.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Factor Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Factor Analysis</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Do it yourself with R
</div>
</div>
<div class="callout-body-container callout-body">
<p>Copy the script <a href="https://github.com/U-Shift/MQAT/blob/main/code/classroom/FactorAnalysis.R"><code>FactorAnalysis.R</code></a> and paste it in your session.<br>
Run each line using <code>CTRL</code> + <code>ENTER</code></p>
</div>
</div>
<p>This exercise is based on the paper “<strong>Residential location satisfaction in the Lisbon metropolitan area</strong>”, by <span class="citation" data-cites="martinez2010">Martinez, Abreu e Silva, and Viegas (<a href="references.html#ref-martinez2010" role="doc-biblioref">2010</a>)</span> .</p>
<p>The aim of this study was to examine the perception of households towards their residential location considering land use and accessibility factors, as well as household socio-economic and attitudinal characteristics.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your task
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create meaningful latent factors.</p>
</div>
</div>
<section id="load-packages" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="load-packages"><span class="header-section-number">7.1</span> Load packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Pack of most used libraries for data science</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools) <span class="co"># Summary of the dataset</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign) <span class="co"># Read SPSS files</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nFactors) <span class="co"># Factor analysis</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GPArotation) <span class="co"># GPA Rotation for Factor Analysis</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># Personality, psychometric, and psychological research</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataset" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="dataset"><span class="header-section-number">7.2</span> Dataset</h2>
<p>Included <strong>variables</strong>:</p>
<ul>
<li><code>RespondentID</code> - ID of the respondent</li>
<li><code>DWELCLAS</code> - Classification of the dwelling</li>
<li><code>INCOME</code> - Income of the household</li>
<li><code>CHILD13</code> - Number of children under 13 years old</li>
<li><code>H18</code> - Number of household members over 18 years old</li>
<li><code>HEMPLOY</code> - Number of household members employed</li>
<li><code>HSIZE</code> - Household size</li>
<li><code>IAGE</code> - Age of the respondent</li>
<li><code>ISEX</code> - Sex of the respondent</li>
<li><code>NCARS</code> - Number of cars in the household</li>
<li><code>AREA</code> - Area of the dwelling</li>
<li><code>BEDROOM</code> - Number of bedrooms in the dwelling</li>
<li><code>PARK</code> - Number of parking spaces in the dwelling</li>
<li><code>BEDSIZE</code> - BEDROOM/HSIZE</li>
<li><code>PARKSIZE</code> - PARK/NCARS</li>
<li><code>RAGE10</code> - 1 if Dwelling age &lt;= 10</li>
<li><code>TCBD</code> - Private car distance in time to CBD</li>
<li><code>DISTTC</code> - Euclidean distance to heavy public transport system stops</li>
<li><code>TWCBD</code> - Private car distance in time of workplace to CBD</li>
<li><code>TDWWK</code> - Private car distance in time of dwelling to work place</li>
<li><code>HEADH</code> - 1 if Head of the Household</li>
<li><code>POPDENS</code> - Population density per hectare</li>
<li><code>EQUINDEX</code> - Number of undergraduate students/Population over 20 years old (500m)</li>
</ul>
<section id="import-dataset" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="import-dataset"><span class="header-section-number">7.2.1</span> Import dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.spss</span>(<span class="st">"../data/example_fact.sav"</span>, <span class="at">to.data.frame =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-to-know-your-dataset" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="get-to-know-your-dataset"><span class="header-section-number">7.2.2</span> Get to know your dataset</h3>
<p>Take a look at the first values of the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  RespondentID DWELCLAS INCOME CHILD13 H18 HEMPLOY HSIZE AVADUAGE IAGE ISEX
1    799161661        5   7500       1   2       2     3 32.00000   32    1
2    798399409        6   4750       0   1       1     1 31.00000   31    1
3    798374392        6   4750       2   2       2     4 41.50000   42    0
4    798275277        5   7500       0   3       2     4 44.66667   52    1
5    798264250        6   2750       1   1       1     2 33.00000   33    0
  NCARS AREA BEDROOM PARK   BEDSIZE PARKSIZE RAGE10      TCBD   DISTHTC
1     2  100       2    1 0.6666667      0.5      1 36.791237  629.1120
2     1   90       2    1 2.0000000      1.0      0 15.472989  550.5769
3     2  220       4    2 1.0000000      1.0      1 24.098125  547.8633
4     3  120       3    0 0.7500000      0.0      0 28.724796 2350.5782
5     1   90       2    0 1.0000000      0.0      0  7.283384  698.3000
      TWCBD    TDWWK HEADH   POPDENS   EDUINDEX   GRAVCPC   GRAVCPT  GRAVPCPT
1 10.003945 31.14282     1  85.70155 0.06406279 0.2492962 0.2492607 1.0001423
2 15.502989  0.00000     1 146.43494 0.26723192 0.3293831 0.3102800 1.0615674
3 12.709374 20.38427     1 106.60810 0.09996816 0.2396229 0.2899865 0.8263245
4  3.168599 32.94246     1  36.78380 0.08671065 0.2734539 0.2487830 1.0991661
5  5.364160 13.04013     1 181.62720 0.13091674 0.2854017 0.2913676 0.9795244
  NSTRTC    DISTHW    DIVIDX    ACTDENS   DISTCBD
1     38 2036.4661 0.3225354  0.6722406  9776.142
2     34  747.7683 0.3484588  2.4860345  3523.994
3     33 2279.0577 0.3237884  1.6249059 11036.407
4      6 1196.4665 0.3272149  1.7664923  6257.262
5     31 3507.2402 0.3545181 11.3249309  1265.239</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data) <span class="co"># open in table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Make the <code>RespondentID</code> variable as <strong>row names</strong> or case number</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data <span class="sc">|&gt;</span> <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"RespondentID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take a look at the main characteristics of the dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   470 obs. of  31 variables:
 $ DWELCLAS: num  5 6 6 5 6 6 4 2 6 5 ...
 $ INCOME  : num  7500 4750 4750 7500 2750 1500 12500 1500 1500 1500 ...
 $ CHILD13 : num  1 0 2 0 1 0 0 0 0 0 ...
 $ H18     : num  2 1 2 3 1 3 3 4 1 1 ...
 $ HEMPLOY : num  2 1 2 2 1 2 0 2 1 1 ...
 $ HSIZE   : num  3 1 4 4 2 3 3 4 1 1 ...
 $ AVADUAGE: num  32 31 41.5 44.7 33 ...
 $ IAGE    : num  32 31 42 52 33 47 62 21 34 25 ...
 $ ISEX    : num  1 1 0 1 0 1 1 0 0 0 ...
 $ NCARS   : num  2 1 2 3 1 1 2 3 1 1 ...
 $ AREA    : num  100 90 220 120 90 100 178 180 80 50 ...
 $ BEDROOM : num  2 2 4 3 2 2 5 3 2 1 ...
 $ PARK    : num  1 1 2 0 0 0 2 0 0 1 ...
 $ BEDSIZE : num  0.667 2 1 0.75 1 ...
 $ PARKSIZE: num  0.5 1 1 0 0 0 1 0 0 1 ...
 $ RAGE10  : num  1 0 1 0 0 0 0 0 1 1 ...
 $ TCBD    : num  36.79 15.47 24.1 28.72 7.28 ...
 $ DISTHTC : num  629 551 548 2351 698 ...
 $ TWCBD   : num  10 15.5 12.71 3.17 5.36 ...
 $ TDWWK   : num  31.1 0 20.4 32.9 13 ...
 $ HEADH   : num  1 1 1 1 1 1 1 0 1 1 ...
 $ POPDENS : num  85.7 146.4 106.6 36.8 181.6 ...
 $ EDUINDEX: num  0.0641 0.2672 0.1 0.0867 0.1309 ...
 $ GRAVCPC : num  0.249 0.329 0.24 0.273 0.285 ...
 $ GRAVCPT : num  0.249 0.31 0.29 0.249 0.291 ...
 $ GRAVPCPT: num  1 1.062 0.826 1.099 0.98 ...
 $ NSTRTC  : num  38 34 33 6 31 45 12 6 4 22 ...
 $ DISTHW  : num  2036 748 2279 1196 3507 ...
 $ DIVIDX  : num  0.323 0.348 0.324 0.327 0.355 ...
 $ ACTDENS : num  0.672 2.486 1.625 1.766 11.325 ...
 $ DISTCBD : num  9776 3524 11036 6257 1265 ...
 - attr(*, "variable.labels")= Named chr(0) 
  ..- attr(*, "names")= chr(0) 
 - attr(*, "codepage")= int 1252</code></pre>
</div>
</div>
<p>Check summary statistics of variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>descriptive_stats <span class="ot">=</span> <span class="fu">dfSummary</span>(data)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(descriptive_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Switching method to 'browser'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Output file written: /tmp/RtmpdCdC76/file73632a86c4cf.html</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We used a different library of the MLR chapter for perfoming the summary statistics.<br>
<strong>R</strong> allows you to do the same or similar tasks with different packages.</p>
</div>
</div>
</section>
</section>
<section id="assumptions-for-factoral-analysis" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="assumptions-for-factoral-analysis"><span class="header-section-number">7.3</span> Assumptions for factoral analysis</h2>
<p>There are some rules of thumb and assumptions that should be checked before performing a factor analysis.</p>
<p><strong>Rules of thumb</strong>:</p>
<ul>
<li><p>At least 10 variables</p></li>
<li><p>n &lt; 50 (Unacceptable); n &gt; 200 (recommended)</p></li>
<li><p>It is recommended to use continuous variables. If your data contains categorical variables, you should transform them to dummy variables.</p></li>
</ul>
<p>As we have 31 variables (none categorical) and more than 200 observations, we can proceed to check the assumptions.</p>
<p><strong>Assumptions</strong>:</p>
<ul>
<li>Normality;</li>
<li>Linearity;</li>
<li>Homogeneity;</li>
<li>Homoscedasticity (some multicollinearity is desirable);</li>
<li>Correlations between variables &lt; 0.3 are not appropriate to use Factor Analysis</li>
</ul>
<p>Let’s run a random regression model in order to evaluate some of the assumptions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random regression model</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>random <span class="ot">=</span> <span class="fu">rchisq</span>(<span class="fu">nrow</span>(data), <span class="fu">ncol</span>(data))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>fake <span class="ot">=</span> <span class="fu">lm</span>(random <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>standardized <span class="ot">=</span> <span class="fu">rstudent</span>(fake)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">=</span> <span class="fu">scale</span>(fake<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="normality" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="normality"><span class="header-section-number">7.3.1</span> Normality</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(standardized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The histogram looks like a normal distribution.</p>
</section>
<section id="linearity" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="linearity"><span class="header-section-number">7.3.2</span> Linearity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(standardized)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The QQ plot shows that the points are close to the diagonal line, indicating linearity.</p>
</section>
<section id="homogeneity" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="homogeneity"><span class="header-section-number">7.3.3</span> Homogeneity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitted, standardized)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals are randomly distributed around zero, indicating homogeneity.</p>
</section>
<section id="correlations-between-variables" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="correlations-between-variables"><span class="header-section-number">7.3.4</span> Correlations between variables</h3>
<p>Correlation matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">=</span> <span class="fu">cor</span>(data, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <strong>Bartlett’s test</strong> examines if there is equal variance (homogeneity) between variables. Thus, it evaluates if there is any pattern between variables.</p>
<section id="correlation-adequacy" class="level4">
<h4 class="anchored" data-anchor-id="correlation-adequacy">Correlation adequacy</h4>
<p>Check for correlation adequacy - Bartlett’s Test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(corr_matrix, <span class="at">n =</span> <span class="fu">nrow</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 9880.074

$p.value
[1] 0

$df
[1] 465</code></pre>
</div>
</div>
<p>The null hypothesis is that there is no correlation between variables. Therefore, you want to <strong>reject</strong> the null hypothesis.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong> A p-value &lt; 0.05 indicates that there are correlations between variables, and that <strong>factor analysis</strong> may be useful with your data.</p>
</blockquote>
</section>
<section id="sampling-adequacy" class="level4">
<h4 class="anchored" data-anchor-id="sampling-adequacy">Sampling adequacy</h4>
<p>Check for sampling adequacy - KMO test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = corr_matrix)
Overall MSA =  0.68
MSA for each item = 
DWELCLAS   INCOME  CHILD13      H18  HEMPLOY    HSIZE AVADUAGE     IAGE 
    0.70     0.85     0.33     0.58     0.88     0.59     0.38     0.40 
    ISEX    NCARS     AREA  BEDROOM     PARK  BEDSIZE PARKSIZE   RAGE10 
    0.71     0.74     0.60     0.53     0.62     0.58     0.57     0.84 
    TCBD  DISTHTC    TWCBD    TDWWK    HEADH  POPDENS EDUINDEX  GRAVCPC 
    0.88     0.88     0.82     0.89     0.47     0.82     0.85     0.76 
 GRAVCPT GRAVPCPT   NSTRTC   DISTHW   DIVIDX  ACTDENS  DISTCBD 
    0.71     0.31     0.83     0.76     0.63     0.70     0.86 </code></pre>
</div>
</div>
<p>We want at least <strong>0.7</strong> of the overall Mean Sample Adequacy (MSA). If, 0.6 &lt; MSA &lt; 0.7, it is not a good value, but acceptable in some cases.</p>
</section>
</section>
</section>
<section id="determine-the-number-of-factors-to-extract" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="determine-the-number-of-factors-to-extract"><span class="header-section-number">7.4</span> Determine the number of factors to extract</h2>
<p>There are several ways to determine the number of factors to extract. Here we will use three different methods:</p>
<ul>
<li>Parallel Analysis</li>
<li>Kaiser Criterion</li>
<li>Principal Component Analysis (PCA)</li>
</ul>
<section id="parallel-analysis" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="parallel-analysis"><span class="header-section-number">7.4.1</span> Parallel Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>num_factors <span class="ot">=</span> <span class="fu">fa.parallel</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> data, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="co"># factor mathod = maximum likelihood</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fa =</span> <span class="st">"fa"</span>) <span class="co"># factor analysis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  8  and the number of components =  NA </code></pre>
</div>
</div>
<p>The selection of the number of factors in the Parallel analysis can be threefold:</p>
<ul>
<li>Detect where there is an “elbow” in the graph;</li>
<li>Detect the intersection between the “FA Actual Data” and the “FA Simulated Data”;</li>
<li>Consider the number of factors with eigenvalue &gt; 1.</li>
</ul>
</section>
<section id="kaiser-criterion" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="kaiser-criterion"><span class="header-section-number">7.4.2</span> Kaiser Criterion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(num_factors<span class="sc">$</span>fa.values <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="co"># Number of factors with eigenvalue &gt; 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(num_factors<span class="sc">$</span>fa.values <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="co"># Number of factors with eigenvalue &gt; 0.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>You can also consider factors with eigenvalue &gt; 0.7, since some of the literature indicate that this value does not overestimate the number of factors as much as considering an eigenvalue = 1.</p>
</section>
<section id="principal-component-analysis-pca" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="principal-component-analysis-pca"><span class="header-section-number">7.4.3</span> Principal Component Analysis (PCA)</h3>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PCA is not the same thing as Factor Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p>PCA only considers the common information (variance) of the variables, while factor analysis takes into account also the unique variance of the variable. Both approaches are often mixed up. In this example we use PCA as only a first criteria for choosing the number of factors. PCA is usually used in image recognition and data reduction of big data.</p>
</div>
</div>
<section id="variance-explained-by-components" class="level4">
<h4 class="anchored" data-anchor-id="variance-explained-by-components">Variance explained by components</h4>
<p>Print variance that explains the components</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_pca <span class="ot">=</span> <span class="fu">princomp</span>(data,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cor =</span> <span class="cn">TRUE</span>) <span class="co"># standardizes your dataset before running a PCA</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_pca)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                         Comp.1    Comp.2     Comp.3     Comp.4     Comp.5
Standard deviation     2.450253 1.9587909 1.61305418 1.43367870 1.27628545
Proportion of Variance 0.193669 0.1237697 0.08393367 0.06630434 0.05254531
Cumulative Proportion  0.193669 0.3174388 0.40137245 0.46767679 0.52022210
                           Comp.6     Comp.7     Comp.8    Comp.9    Comp.10
Standard deviation     1.26612033 1.22242045 1.11550534 1.0304937 0.99888665
Proportion of Variance 0.05171164 0.04820361 0.04014039 0.0342554 0.03218628
Cumulative Proportion  0.57193374 0.62013734 0.66027774 0.6945331 0.72671941
                          Comp.11    Comp.12   Comp.13    Comp.14    Comp.15
Standard deviation     0.97639701 0.92221635 0.9042314 0.85909928 0.80853555
Proportion of Variance 0.03075326 0.02743494 0.0263753 0.02380812 0.02108806
Cumulative Proportion  0.75747267 0.78490761 0.8112829 0.83509102 0.85617908
                         Comp.16    Comp.17    Comp.18    Comp.19    Comp.20
Standard deviation     0.7877571 0.74436225 0.72574751 0.69380677 0.67269732
Proportion of Variance 0.0200181 0.01787339 0.01699063 0.01552799 0.01459747
Cumulative Proportion  0.8761972 0.89407058 0.91106120 0.92658920 0.94118667
                          Comp.21    Comp.22    Comp.23     Comp.24     Comp.25
Standard deviation     0.63466979 0.61328635 0.55192724 0.397467153 0.384354087
Proportion of Variance 0.01299373 0.01213291 0.00982657 0.005096133 0.004765421
Cumulative Proportion  0.95418041 0.96631331 0.97613988 0.981236017 0.986001438
                           Comp.26     Comp.27     Comp.28     Comp.29
Standard deviation     0.364232811 0.322026864 0.276201256 0.262018088
Proportion of Variance 0.004279534 0.003345203 0.002460875 0.002214628
Cumulative Proportion  0.990280972 0.993626175 0.996087050 0.998301679
                            Comp.30      Comp.31
Standard deviation     0.1712372644 0.1527277294
Proportion of Variance 0.0009458774 0.0007524438
Cumulative Proportion  0.9992475562 1.0000000000</code></pre>
</div>
</div>
</section>
<section id="scree-plot" class="level4">
<h4 class="anchored" data-anchor-id="scree-plot">Scree Plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data_pca, <span class="at">type =</span> <span class="st">"lines"</span>, <span class="at">npcs =</span> <span class="dv">31</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Check the cumulative variance of the first components and the scree plot, and see if the PCA is a good approach to detect the number of factors in this case.</p>
</section>
</section>
</section>
<section id="exploratory-factor-analysis-efa" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="exploratory-factor-analysis-efa"><span class="header-section-number">7.5</span> Exploratory Factor Analysis (EFA)</h2>
<section id="rotational-indeterminacy" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="rotational-indeterminacy"><span class="header-section-number">7.5.1</span> Rotational indeterminacy</h3>
<p>We can rotate the factors, so that the loadings will be as close as possible to a desired structure.</p>
<p>There are two types of rotation methods.</p>
<section id="orthogonal" class="level4">
<h4 class="anchored" data-anchor-id="orthogonal"><strong>Orthogonal</strong></h4>
<p>Orthogonal rotation clarifies factor structure <strong>while preserving independence between factors</strong> - assumes the factors are independent from each other (i.e., their correlation is zero).<br>
The underlying factors after rotation will be <strong>uncorrelated</strong>.</p>
<p>The method rotates the factor axes while <strong>keeping them perpendicular</strong>, so the factors remain uncorrelated.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-435754132.png" class="img-fluid figure-img" width="500"></p>
<figcaption>Based in <span class="citation" data-cites="field2024spss">Field (<a href="references.html#ref-field2024spss" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
<p>The goal is to <strong>increase</strong> each item’s loading on <strong>one main factor</strong>, and <strong>reduce</strong> its loadings on the other factors, which makes the factors <strong>easier to interpret</strong>.</p>
<p>Methods include:</p>
<ul>
<li>Varimax</li>
<li>Quartimax</li>
<li>Equimax</li>
</ul>
</section>
<section id="oblique" class="level4">
<h4 class="anchored" data-anchor-id="oblique"><strong>Oblique</strong></h4>
<p>Oblique rotation improves factor interpretability while allowing the factors to be <strong>correlated</strong> with each other. Unlike orthogonal rotation, it does <strong>not</strong> force the factors to remain independent.</p>
<p>Because of this, oblique methods are often more suitable for complex and interrelated constructs, where some degree of relationship between factors is expected.</p>
<p>Oblique rotation does <strong>not</strong> require the factor axes to stay perpendicular. As a result, the rotated factors can <strong>correlate</strong>, allowing a more realistic representation of how variables relate to multiple underlying dimensions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-4248373259.png" class="img-fluid figure-img" width="500"></p>
<figcaption>Based in <span class="citation" data-cites="field2024spss">Field (<a href="references.html#ref-field2024spss" role="doc-biblioref">2024</a>)</span></figcaption>
</figure>
</div>
<p>Methods include:</p>
<ul>
<li>Oblimin</li>
<li>Qaurtimin</li>
<li>Promax</li>
</ul>
<p>Let’s run three different factor analysis models with different rotation methods:</p>
<ul>
<li><strong>Model 1</strong>: No rotation</li>
<li><strong>Model 2</strong>: Rotation Varimax</li>
<li><strong>Model 3</strong>: Rotation Oblimin</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No rotation</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data_factor <span class="ot">=</span> <span class="fu">factanal</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">factors =</span> <span class="dv">4</span>, <span class="co"># change here the number of facotrs based on the EFA</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"none"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scores =</span> <span class="st">"regression"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotation Varimax</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>data_factor_var <span class="ot">=</span> <span class="fu">factanal</span>(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">factors =</span> <span class="dv">4</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"varimax"</span>, <span class="co"># orthogonal rotation (default)</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">scores =</span> <span class="st">"regression"</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotation Oblimin</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>data_factor_obl <span class="ot">=</span> <span class="fu">factanal</span>(</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  data, </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">factors =</span> <span class="dv">4</span>,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"oblimin"</span>, <span class="co"># oblique rotation</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">scores =</span> <span class="st">"regression"</span>,</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Print out the results of <code>data_factor_obl</code>, and have a look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_factor_obl,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">cutoff =</span> <span class="fl">0.3</span>, <span class="co"># &gt; 0.3 due to the sample size is higher than 350 observations.</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
factanal(x = data, factors = 4, scores = "regression", rotation = "oblimin",     fm = "ml")

Uniquenesses:
DWELCLAS   INCOME  CHILD13      H18  HEMPLOY    HSIZE AVADUAGE     IAGE 
    0.98     0.82     0.09     0.01     0.73     0.01     0.98     0.99 
    ISEX    NCARS     AREA  BEDROOM     PARK  BEDSIZE PARKSIZE   RAGE10 
    0.98     0.64     0.93     0.79     0.89     0.62     0.92     0.91 
    TCBD  DISTHTC    TWCBD    TDWWK    HEADH  POPDENS EDUINDEX  GRAVCPC 
    0.14     0.54     0.80     0.74     0.67     0.78     0.71     0.04 
 GRAVCPT GRAVPCPT   NSTRTC   DISTHW   DIVIDX  ACTDENS  DISTCBD 
    0.05     0.01     0.85     0.66     0.84     0.80     0.31 

Loadings:
         Factor1 Factor2 Factor3 Factor4
TCBD      0.93                          
DISTHTC   0.62                          
EDUINDEX -0.53                          
GRAVCPC  -0.98                          
GRAVCPT  -0.74           -0.55          
DISTHW    0.56                          
DISTCBD   0.81                          
H18               1.02                  
HSIZE             0.74            0.54  
NCARS             0.57                  
BEDSIZE          -0.52                  
HEADH            -0.56                  
GRAVPCPT                  1.00          
CHILD13                           0.97  
DWELCLAS                                
INCOME            0.38                  
HEMPLOY           0.47                  
AVADUAGE                                
IAGE                                    
ISEX                                    
AREA                                    
BEDROOM           0.37                  
PARK                                    
PARKSIZE                                
RAGE10                                  
TWCBD     0.43                          
TDWWK     0.49                          
POPDENS  -0.41                          
NSTRTC   -0.37                          
DIVIDX   -0.40                          
ACTDENS  -0.42                          

            Factor1 Factor2 Factor3 Factor4
SS loadings    5.24    3.13    1.66    1.57

Factor Correlations:
        Factor1 Factor2 Factor3 Factor4
Factor1   1.000   0.062   0.117   0.021
Factor2   0.062   1.000   0.011   0.199
Factor3   0.117   0.011   1.000   0.054
Factor4   0.021   0.199   0.054   1.000

Test of the hypothesis that 4 factors are sufficient.
The chi square statistic is 3628.43 on 347 degrees of freedom.
The p-value is 0 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The variability contained in the factors is equal to <code>Communality</code> + <code>Uniqueness</code>.</p>
</blockquote>
</section>
</section>
<section id="factor-scores-and-factor-loadings" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="factor-scores-and-factor-loadings"><span class="header-section-number">7.5.2</span> Factor scores and factor loadings</h3>
<p>In addition to the loading structure, you may also want to know the factor scores of each observation.</p>
<p>We can extract the factor scores with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data_factor_obl<span class="sc">$</span>scores)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(data_factor_obl$scores, "data/data_factor_obl_scores.csv", sep = "\t")</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_factor_obl<span class="sc">$</span>scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Factor1     Factor2    Factor3    Factor4
799161661  0.5269517 -0.01526867 -0.4212963  0.6723761
798399409 -0.6999716 -1.28451045 -0.3425305 -0.5906694
798374392  0.3140942  0.17925007 -1.0077065  1.8899099
798275277  0.2576954  1.09054593 -0.1178061  0.3756358
798264250 -0.3366206 -1.08082681 -0.5807561  0.6090050
798235878 -0.5993148  0.84250056  1.2619817 -0.5142385</code></pre>
</div>
</div>
<p>The individual indicator/subtest scores would be the <strong>weighted sum of the factor scores</strong>, where the weights are the determined by <strong>factor loadings</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data_factor_obl<span class="sc">$</span>loadings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in format.data.frame(x0): corrupt data frame: columns will be truncated
or padded with NAs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(data_factor_obl$loadings, "data/data_factor_obl_loadings.csv", sep = "\t")</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_factor_obl<span class="sc">$</span>loadings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Factor1     Factor2     Factor3     Factor4
DWELCLAS -0.0333847085 -0.04628588  0.13740126  0.03391240
INCOME   -0.1309767372  0.37518984  0.04293329  0.10335426
CHILD13   0.0041194104 -0.06692967  0.00769277  0.96689496
H18       0.0008958126  1.01553559 -0.01668507 -0.17758151
HEMPLOY   0.0638121517  0.47320725  0.07699066  0.09956475
HSIZE    -0.0081682615  0.73984312 -0.01057724  0.53609771</code></pre>
</div>
</div>
</section>
<section id="visualize-rotation" class="level3" data-number="7.5.3">
<h3 data-number="7.5.3" class="anchored" data-anchor-id="visualize-rotation"><span class="header-section-number">7.5.3</span> Visualize Rotation</h3>
<p>We will define a plot function to make it easier to visualize several factor pairs.</p>
<div class="cell">
<details class="code-fold">
<summary>Plot function</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a plot function</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plot_factor_loading <span class="ot">&lt;-</span> <span class="cf">function</span>(data_factor,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f1 =</span> <span class="dv">1</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f2 =</span> <span class="dv">2</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">"No rotation"</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">color =</span> <span class="st">"blue"</span>) {</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to numeric matrix (works for psych loadings objects)</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data_factor<span class="sc">$</span>loadings)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract selected factors</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">item =</span> <span class="fu">rownames</span>(L), <span class="at">x =</span> L[, f1], <span class="at">y =</span> L[, f2])</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> item)) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">color =</span> color,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Factor "</span>, f1),</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Factor "</span>, f2),</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> method</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="no-rotation" class="level4">
<h4 class="anchored" data-anchor-id="no-rotation">No Rotation</h4>
<p>Plot factor 1 against factor 2, and compare the results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_factor_loading</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_factor =</span> data_factor, <span class="co"># model no rotation</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="dv">1</span>, <span class="co"># Factor 1</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="dv">2</span>, <span class="co"># Factor 2</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="co"># plot title</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="varimax-rotation" class="level4">
<h4 class="anchored" data-anchor-id="varimax-rotation">Varimax Rotation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_factor_loading</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_factor =</span> data_factor_var, <span class="co"># model varimax</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="dv">1</span>, <span class="co"># Factor 1</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="dv">2</span>, <span class="co"># Factor 2</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Varimax rotation"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="oblimin-rotation" class="level4">
<h4 class="anchored" data-anchor-id="oblimin-rotation">Oblimin Rotation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_factor_loading</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_factor =</span> data_factor_var, <span class="co"># model oblimn</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="dv">1</span>, <span class="co"># Factor 1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="dv">2</span>, <span class="co"># Factor 2</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Oblimin rotation"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"darkgreen"</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When we have more than two factors it is difficult to analyse the factors by the plots.</p>
<p>Variables that have low explaining variance in the two factors analysed, could be highly explained by the other factors not present in the graph.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your turn
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try comparing the plots with the factor loadings and plot the other factor pairs (replace <code>f1</code> and <code>f2</code>) to get more familiar with exploratory factor analysis.<br>
Interpret the factors and try to give them a name.</p>
</div>
</div>
<p>For instance, we can plot all the factors against each other as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create all combinations</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">1</span>, <span class="dv">2</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">1</span>, <span class="dv">3</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>p23 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>p24 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">2</span>, <span class="dv">4</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>p34 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">3</span>, <span class="dv">4</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>(p12 <span class="sc">+</span> p13 <span class="sc">+</span> p14) <span class="sc">/</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>(p23 <span class="sc">+</span> p24 <span class="sc">+</span> p34)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="factor-analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-field2024spss" class="csl-entry" role="listitem">
Field, A. 2024. <em>Discovering Statistics Using IBM SPSS Statistics</em>. 6th ed. SAGE Publications. <a href="https://books.google.pt/books?id=83L2EAAAQBAJ">https://books.google.pt/books?id=83L2EAAAQBAJ</a>.
</div>
<div id="ref-martinez2010" class="csl-entry" role="listitem">
Martinez, Luís Garrido, João de Abreu e Silva, and José Manuel Viegas. 2010. <span>“<span class="nocase">Assessment of Residential Location Satisfaction in the Lisbon Metropolitan Area</span>.”</span> In. <a href="https://trid.trb.org/View/909819">https://trid.trb.org/View/909819</a>.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/U-Shift\.github\.io\/MQAT");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./linear-regression.html" class="pagination-link" aria-label="Multiple Linear Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./clusters.html" class="pagination-link" aria-label="Cluster Analysis">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Factor Analysis"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> false</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="an">number-depth:</span><span class="co"> 3</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple"}</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## Do it yourself with R</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>Copy the script <span class="co">[</span><span class="ot">`FactorAnalysis.R`</span><span class="co">](https://github.com/U-Shift/MQAT/blob/main/code/classroom/FactorAnalysis.R)</span> and paste it in your session.\</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>Run each line using <span class="in">`CTRL`</span> + <span class="in">`ENTER`</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>This exercise is based on the paper "**Residential location satisfaction in the Lisbon metropolitan area**", by @martinez2010 .</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>The aim of this study was to examine the perception of households towards their residential location considering land use and accessibility factors, as well as household socio-economic and attitudinal characteristics.</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Your task</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>Create meaningful latent factors.</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load packages</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Pack of most used libraries for data science</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools) <span class="co"># Summary of the dataset</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign) <span class="co"># Read SPSS files</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nFactors) <span class="co"># Factor analysis</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GPArotation) <span class="co"># GPA Rotation for Factor Analysis</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># Personality, psychometric, and psychological research</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>Included **variables**:</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`RespondentID`</span> - ID of the respondent</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DWELCLAS`</span> - Classification of the dwelling</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`INCOME`</span> - Income of the household</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`CHILD13`</span> - Number of children under 13 years old</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`H18`</span> - Number of household members over 18 years old</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`HEMPLOY`</span> - Number of household members employed</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`HSIZE`</span> - Household size</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`IAGE`</span> - Age of the respondent</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ISEX`</span> - Sex of the respondent</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`NCARS`</span> - Number of cars in the household</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`AREA`</span> - Area of the dwelling</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BEDROOM`</span> - Number of bedrooms in the dwelling</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`PARK`</span> - Number of parking spaces in the dwelling</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BEDSIZE`</span> - BEDROOM/HSIZE</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`PARKSIZE`</span> - PARK/NCARS</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`RAGE10`</span> - 1 if Dwelling age <span class="sc">\&lt;</span>= 10</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`TCBD`</span> - Private car distance in time to CBD</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DISTTC`</span> - Euclidean distance to heavy public transport system stops</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`TWCBD`</span> - Private car distance in time of workplace to CBD</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`TDWWK`</span> - Private car distance in time of dwelling to work place</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`HEADH`</span> - 1 if Head of the Household</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`POPDENS`</span> - Population density per hectare</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`EQUINDEX`</span> - Number of undergraduate students/Population over 20 years old (500m)</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### Import dataset</span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.spss</span>(<span class="st">"../data/example_fact.sav"</span>, <span class="at">to.data.frame =</span> T)</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="fu">### Get to know your dataset</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>Take a look at the first values of the dataset</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data, <span class="dv">5</span>)</span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data) <span class="co"># open in table</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>Make the <span class="in">`RespondentID`</span> variable as **row names** or case number</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data <span class="sc">|&gt;</span> <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"RespondentID"</span>)</span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a>Take a look at the main characteristics of the dataset</span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a>Check summary statistics of variables</span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a>descriptive_stats <span class="ot">=</span> <span class="fu">dfSummary</span>(data)</span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(descriptive_stats)</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Note</span></span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a>We used a different library of the MLR chapter for perfoming the summary statistics.\</span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a>**R** allows you to do the same or similar tasks with different packages.</span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assumptions for factoral analysis</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a>There are some rules of thumb and assumptions that should be checked before performing a factor analysis.</span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a>**Rules of thumb**:</span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>At least 10 variables</span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>n <span class="sc">\&lt;</span> 50 (Unacceptable); n <span class="sc">\&gt;</span> 200 (recommended)</span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>It is recommended to use continuous variables.</span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a>    If your data contains categorical variables, you should transform them to dummy variables.</span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>As we have 31 variables (none categorical) and more than 200 observations, we can proceed to check the assumptions.</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a>**Assumptions**:</span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Normality;</span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Linearity;</span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Homogeneity;</span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Homoscedasticity (some multicollinearity is desirable);</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Correlations between variables <span class="sc">\&lt;</span> 0.3 are not appropriate to use Factor Analysis</span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a>Let's run a random regression model in order to evaluate some of the assumptions.</span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a><span class="co"># random regression model</span></span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>random <span class="ot">=</span> <span class="fu">rchisq</span>(<span class="fu">nrow</span>(data), <span class="fu">ncol</span>(data))</span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a>fake <span class="ot">=</span> <span class="fu">lm</span>(random <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a>standardized <span class="ot">=</span> <span class="fu">rstudent</span>(fake)</span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">=</span> <span class="fu">scale</span>(fake<span class="sc">$</span>fitted.values)</span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normality</span></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(standardized)</span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a>The histogram looks like a normal distribution.</span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linearity</span></span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(standardized)</span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a>The QQ plot shows that the points are close to the diagonal line, indicating linearity.</span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homogeneity</span></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitted, standardized)</span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="dv">0</span>)</span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a>The residuals are randomly distributed around zero, indicating homogeneity.</span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correlations between variables</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a>Correlation matrix</span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">=</span> <span class="fu">cor</span>(data, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a>The **Bartlett's test** examines if there is equal variance (homogeneity) between variables.</span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a>Thus, it evaluates if there is any pattern between variables.</span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Correlation adequacy</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a>Check for correlation adequacy - Bartlett's Test</span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(corr_matrix, <span class="at">n =</span> <span class="fu">nrow</span>(data))</span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a>The null hypothesis is that there is no correlation between variables.</span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a>Therefore, you want to **reject** the null hypothesis.</span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Note:** A p-value \&lt; 0.05 indicates that there are correlations between variables, and that **factor analysis** may be useful with your data.</span></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sampling adequacy</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a>Check for sampling adequacy - KMO test</span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(corr_matrix)</span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a>We want at least **0.7** of the overall Mean Sample Adequacy (MSA).</span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a>If, 0.6 <span class="sc">\&lt;</span> MSA <span class="sc">\&lt;</span> 0.7, it is not a good value, but acceptable in some cases.</span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a><span class="fu">## Determine the number of factors to extract</span></span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a>There are several ways to determine the number of factors to extract.</span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a>Here we will use three different methods:</span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parallel Analysis</span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Kaiser Criterion</span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Principal Component Analysis (PCA)</span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parallel Analysis</span></span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a>num_factors <span class="ot">=</span> <span class="fu">fa.parallel</span>(</span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> data, </span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span>, <span class="co"># factor mathod = maximum likelihood</span></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a>  <span class="at">fa =</span> <span class="st">"fa"</span>) <span class="co"># factor analysis</span></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a>The selection of the number of factors in the Parallel analysis can be threefold:</span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Detect where there is an "elbow" in the graph;</span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Detect the intersection between the "FA Actual Data" and the "FA Simulated Data";</span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider the number of factors with eigenvalue <span class="sc">\&gt;</span> 1.</span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kaiser Criterion</span></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(num_factors<span class="sc">$</span>fa.values <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="co"># Number of factors with eigenvalue &gt; 1</span></span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(num_factors<span class="sc">$</span>fa.values <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="co"># Number of factors with eigenvalue &gt; 0.7</span></span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a>You can also consider factors with eigenvalue <span class="sc">\&gt;</span> 0.7, since some of the literature indicate that this value does not overestimate the number of factors as much as considering an eigenvalue = 1.</span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a><span class="fu">### Principal Component Analysis (PCA)</span></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning appearance="simple"}</span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA is not the same thing as Factor Analysis</span></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a>PCA only considers the common information (variance) of the variables, while factor analysis takes into account also the unique variance of the variable.</span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a>Both approaches are often mixed up.</span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a>In this example we use PCA as only a first criteria for choosing the number of factors.</span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a>PCA is usually used in image recognition and data reduction of big data.</span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variance explained by components</span></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a>Print variance that explains the components</span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a>data_pca <span class="ot">=</span> <span class="fu">princomp</span>(data,</span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cor =</span> <span class="cn">TRUE</span>) <span class="co"># standardizes your dataset before running a PCA</span></span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_pca)  </span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Scree Plot</span></span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data_pca, <span class="at">type =</span> <span class="st">"lines"</span>, <span class="at">npcs =</span> <span class="dv">31</span>)</span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a>Check the cumulative variance of the first components and the scree plot, and see if the PCA is a good approach to detect the number of factors in this case.</span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory Factor Analysis (EFA)</span></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rotational indeterminacy</span></span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>We can rotate the factors, so that the loadings will be as close as possible to a desired structure.</span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a>There are two types of rotation methods.</span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Orthogonal**</span></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a>Orthogonal rotation clarifies factor structure **while preserving independence between factors** - assumes the factors are independent from each other (i.e., their correlation is zero).</span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a>The underlying factors after rotation will be **uncorrelated**.</span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a>The method rotates the factor axes while **keeping them perpendicular**, so the factors remain uncorrelated.</span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="al">![Based in @field2024spss](images/clipboard-435754132.png)</span>{fig-align="center" width="500"}</span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a>The goal is to **increase** each item’s loading on **one main factor**, and **reduce** its loadings on the other factors, which makes the factors **easier to interpret**.</span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>Methods include:</span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Varimax</span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quartimax</span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Equimax</span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Oblique** </span></span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a>Oblique rotation improves factor interpretability while allowing the factors to be **correlated** with each other.</span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a>Unlike orthogonal rotation, it does **not** force the factors to remain independent.</span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a>Because of this, oblique methods are often more suitable for complex and interrelated constructs, where some degree of relationship between factors is expected.</span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a>Oblique rotation does **not** require the factor axes to stay perpendicular.</span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a>As a result, the rotated factors can **correlate**, allowing a more realistic representation of how variables relate to multiple underlying dimensions.</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a><span class="al">![Based in @field2024spss](images/clipboard-4248373259.png)</span>{fig-align="center" width="500"}</span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>Methods include:</span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Oblimin</span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Qaurtimin</span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Promax</span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a>Let's run three different factor analysis models with different rotation methods:</span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model 1**: No rotation</span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model 2**: Rotation Varimax</span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model 3**: Rotation Oblimin</span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a><span class="co"># No rotation</span></span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a>data_factor <span class="ot">=</span> <span class="fu">factanal</span>(</span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a>  <span class="at">factors =</span> <span class="dv">4</span>, <span class="co"># change here the number of facotrs based on the EFA</span></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"none"</span>,</span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a>  <span class="at">scores =</span> <span class="st">"regression"</span>,</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotation Varimax</span></span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a>data_factor_var <span class="ot">=</span> <span class="fu">factanal</span>(</span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">factors =</span> <span class="dv">4</span>,</span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"varimax"</span>, <span class="co"># orthogonal rotation (default)</span></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">scores =</span> <span class="st">"regression"</span>,</span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotation Oblimin</span></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a>data_factor_obl <span class="ot">=</span> <span class="fu">factanal</span>(</span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a>  data, </span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">factors =</span> <span class="dv">4</span>,</span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="st">"oblimin"</span>, <span class="co"># oblique rotation</span></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">scores =</span> <span class="st">"regression"</span>,</span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a>  <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a>Print out the results of <span class="in">`data_factor_obl`</span>, and have a look.</span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data_factor_obl,</span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a>      <span class="at">cutoff =</span> <span class="fl">0.3</span>, <span class="co"># &gt; 0.3 due to the sample size is higher than 350 observations.</span></span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a>      <span class="at">sort =</span> <span class="cn">TRUE</span>) </span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The variability contained in the factors is equal to </span><span class="in">`Communality`</span><span class="at"> + </span><span class="in">`Uniqueness`</span><span class="at">.</span></span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factor scores and factor loadings</span></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a>In addition to the loading structure, you may also want to know the factor scores of each observation.</span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a>We can extract the factor scores with</span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data_factor_obl<span class="sc">$</span>scores)</span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(data_factor_obl$scores, "data/data_factor_obl_scores.csv", sep = "\t")</span></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_factor_obl<span class="sc">$</span>scores)</span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a>The individual indicator/subtest scores would be the **weighted sum of the factor scores**, where the weights are the determined by **factor loadings**.</span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data_factor_obl<span class="sc">$</span>loadings)</span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(data_factor_obl$loadings, "data/data_factor_obl_loadings.csv", sep = "\t")</span></span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_factor_obl<span class="sc">$</span>loadings)</span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualize Rotation</span></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a>We will define a plot function to make it easier to visualize several factor pairs.</span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Plot function"</span></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a><span class="co"># define a plot function</span></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a>plot_factor_loading <span class="ot">&lt;-</span> <span class="cf">function</span>(data_factor,</span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f1 =</span> <span class="dv">1</span>,</span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f2 =</span> <span class="dv">2</span>,</span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">"No rotation"</span>,</span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a>                                <span class="at">color =</span> <span class="st">"blue"</span>) {</span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to numeric matrix (works for psych loadings objects)</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data_factor<span class="sc">$</span>loadings)</span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract selected factors</span></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">item =</span> <span class="fu">rownames</span>(L), <span class="at">x =</span> L[, f1], <span class="at">y =</span> L[, f2])</span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> item)) <span class="sc">+</span></span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">color =</span> color,</span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Factor "</span>, f1),</span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Factor "</span>, f2),</span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> method</span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a><span class="fu">#### No Rotation</span></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a>Plot factor 1 against factor 2, and compare the results</span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_factor_loading</span>(</span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_factor =</span> data_factor, <span class="co"># model no rotation</span></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="dv">1</span>, <span class="co"># Factor 1</span></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="dv">2</span>, <span class="co"># Factor 2</span></span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="co"># plot title</span></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varimax Rotation</span></span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_factor_loading</span>(</span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_factor =</span> data_factor_var, <span class="co"># model varimax</span></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="dv">1</span>, <span class="co"># Factor 1</span></span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="dv">2</span>, <span class="co"># Factor 2</span></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Varimax rotation"</span>,</span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Oblimin Rotation</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_factor_loading</span>(</span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_factor =</span> data_factor_var, <span class="co"># model oblimn</span></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="dv">1</span>, <span class="co"># Factor 1</span></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="dv">2</span>, <span class="co"># Factor 2</span></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"Oblimin rotation"</span>,</span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"darkgreen"</span></span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a>When we have more than two factors it is difficult to analyse the factors by the plots.</span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a>Variables that have low explaining variance in the two factors analysed, could be highly explained by the other factors not present in the graph.</span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple"}</span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a><span class="fu">## Your turn</span></span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a>Try comparing the plots with the factor loadings and plot the other factor pairs (replace <span class="in">`f1`</span> and <span class="in">`f2`</span>) to get more familiar with exploratory factor analysis.\</span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a>Interpret the factors and try to give them a name.</span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a>For instance, we can plot all the factors against each other as follows:</span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a><span class="co"># create all combinations</span></span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">1</span>, <span class="dv">2</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">1</span>, <span class="dv">3</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a>p23 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">2</span>, <span class="dv">3</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a>p24 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">2</span>, <span class="dv">4</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a>p34 <span class="ot">&lt;-</span> <span class="fu">plot_factor_loading</span>(data_factor, <span class="dv">3</span>, <span class="dv">4</span>, <span class="at">method =</span> <span class="st">"No rotation"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a>(p12 <span class="sc">+</span> p13 <span class="sc">+</span> p14) <span class="sc">/</span></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a>(p23 <span class="sc">+</span> p24 <span class="sc">+</span> p34)</span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>R Félix, G Valença, F Moura</p>
</div>   
    <div class="nav-footer-center">
<p>MQAT - Instituto Superior Técnico</p>
</div>
    <div class="nav-footer-right">
<p>September 2025</p>
</div>
  </div>
</footer>




</body></html>